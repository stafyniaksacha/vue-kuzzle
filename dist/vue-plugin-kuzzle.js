!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("kuzzle-sdk")):"function"==typeof define&&define.amd?define(["kuzzle-sdk"],t):"object"==typeof exports?exports.VuePluginKuzzle=t(require("kuzzle-sdk")):e.VuePluginKuzzle=t(e["kuzzle-sdk"])}("undefined"!=typeof self?self:this,function(e){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=3)}([function(e,t){e.exports=function(e,t,n,i,o,s){var r,u=e=e||{},l=typeof e.default;"object"!==l&&"function"!==l||(r=e,u=e.default);var c,a="function"==typeof u?u.options:u;if(t&&(a.render=t.render,a.staticRenderFns=t.staticRenderFns,a._compiled=!0),n&&(a.functional=!0),o&&(a._scopeId=o),s?(c=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),i&&i.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(s)},a._ssrRegister=c):i&&(c=i),c){var d=a.functional,f=d?a.render:a.beforeCreate;d?(a._injectStyles=c,a.render=function(e,t){return c.call(t),f(e,t)}):a.beforeCreate=f?[].concat(f,c):[c]}return{esModule:r,exports:u,options:a}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"KuzzleDocumentSearch",props:{index:{type:String,required:!0},collection:{type:String,required:!0},query:{type:Object,default:void 0},options:{type:Object,default:void 0}},kuzzle:{async connected(){await this._search()},async reconnected(){await this._search()}},data:()=>({hits:[],total:0,error:null,loading:!1}),methods:{async _search(){this.error=null,this.loading=!0;try{const e=await this.$kuzzle.document.search(this.index,this.collection,this.query,this.options);this.hits=e.hits,this.total=e.total}catch(e){this.hits=[],this.total=0,this.error=e}finally{this.loading=!1}}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"KuzzleDocumentSubscribe",props:{hit:{type:Object,required:!0}},kuzzle:{async connected(){await this._subscribe()},async reconnected(){await this._subscribe()}},data:()=>({roomId:null,syncedSource:{},error:null,loading:!1}),created(){this.syncedSource=this.hit._source},methods:{async _subscribe(){this.error=null,this.loading=!0,this.roomId&&this.$kuzzle.realtime.unsubscribe(this.roomId),console.log("subscribe:",this.hit);try{this.roomId=await this.$kuzzle.realtime.subscribe(this.hit._index,this.hit._type,{ids:{values:[this.hit._id]}},e=>{this.syncedSource=e.result._source})}catch(e){this.syncedSource=this.hit._source,this.error=e}finally{this.loading=!1}}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.flattenHits=void 0;var i=n(4),o=r(n(5)),s=r(n(7));function r(e){return e&&e.__esModule?e:{default:e}}const u=["connected","discarded","disconnected","loginAttempt","networkError","offlineQueuePush","offlineQueuePop","queryError","reconnected","tokenExpired"];let l,c=!1;t.default=class{static get kuzzle(){return l}static set kuzzle(e){if(l instanceof i.Kuzzle){for(let t of u){let n=l.listeners(t);for(let i of n)e.addListener(t,i)}l.protocol.isReady()&&(l.disconnect(),e.connect())}l=e}static get installed(){return c}static set installed(e){c=e}static install(e,t=new i.Kuzzle(new i.WebSocket("localhost"))){this.kuzzle=t,Object.defineProperty(e.prototype,"$kuzzle",{get:e=>this.kuzzle,set:e=>{this.kuzzle=e}}),e.component("KuzzleDocumentSearch",o.default),e.component("KuzzleDocumentSubscribe",s.default),e.mixin({async created(){let e=this.$options.kuzzle;for(let t in e)if(u.includes(t)){if("function"!=typeof this.$options.kuzzle[t]){console.warn(`[VuePluginKuzzle] Listener for "${t}" event should be a function`);continue}switch(t){case"disconnected":this.$kuzzle.protocol.isReady()||await this.$options.kuzzle[t].call(this),this.$kuzzle.addListener(t,async e=>{await this.$options.kuzzle[t].call(this)});break;case"connected":this.$kuzzle.protocol.isReady()&&await this.$options.kuzzle[t].call(this),this.$kuzzle.addListener(t,async e=>{await this.$options.kuzzle[t].call(this)});break;default:this.$kuzzle.addListener(t,async e=>{await this.$options.kuzzle[t].call(this,e)})}}},beforeDestroy(){let e=this.$options.kuzzle;for(let t in e)if(u.includes(t)){if("function"!=typeof this.$options.kuzzle[t]){console.warn(`[VuePluginKuzzle] Listener for "${t}" event should be a function`);continue}this.$kuzzle.removeListener(t,this.$options.kuzzle[t])}}})}},t.flattenHits=function(e){return e.hits.map(e=>({_source:e._source,_id:e._id,_meta:e._meta}))}},function(t,n){t.exports=e},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),o=n.n(i);for(var s in i)"default"!==s&&function(e){n.d(t,e,function(){return i[e]})}(s);var r=n(6),u=n(0)(o.a,r.a,!1,null,null,null);u.options.__file="lib/components/KuzzleDocumentSearch.vue",t.default=u.exports},function(e,t,n){"use strict";var i=function(){var e=this.$createElement;return(this._self._c||e)("div",[this._t("default",null,{hits:this.hits,total:this.total,loading:this.loading,error:this.error})],2)};i._withStripped=!0;var o={render:i,staticRenderFns:[]};t.a=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),o=n.n(i);for(var s in i)"default"!==s&&function(e){n.d(t,e,function(){return i[e]})}(s);var r=n(8),u=n(0)(o.a,r.a,!1,null,null,null);u.options.__file="lib/components/KuzzleDocumentSubscribe.vue",t.default=u.exports},function(e,t,n){"use strict";var i=function(){var e=this.$createElement;return(this._self._c||e)("div",[this._t("default",null,{syncedSource:this.syncedSource,error:this.error,loading:this.loading})],2)};i._withStripped=!0;var o={render:i,staticRenderFns:[]};t.a=o}])});